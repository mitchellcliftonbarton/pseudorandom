var express=require("express"),app=express(),path=require("path"),fs=require("fs");app.use(express["static"]("public")),app.get("/",function(e,n){n.sendFile("index.html")}),app.get("/grid",function(e,n,a){n.sendFile("grid.html",{root:path.join(__dirname,"public")})}),app.get("/loop",function(e,n,a){n.sendFile("lg-view.html",{root:path.join(__dirname,"public")})}),app.get("/data-view",function(e,n,a){n.sendFile("data-display.html",{root:path.join(__dirname,"public")})}),app.get("/images",function(e,n,a){fs.readdir("public/new-images",function(e,a){e&&console.log(e),console.log(a),n.send(a)})}),app.post("/save",function(e,n,a){function t(e){e?console.log("broken"):console.log("yay")}var o="";e.on("data",function(e){o+=e,console.log("yay wut!")}),e.on("end",function(){var e=o.indexOf("data"),n=o.slice(0,e),a=o.toString().indexOf(",")+1,t=new Buffer(o.substring(a),"base64");fs.writeFile("public/new-images/"+n+".jpg",t,function(e){})}),n.send("Done")});var dataStore=[];app.post("/data-save",function(e,n,a){e.on("data",function(e){dataStore.push(e)}),n.send("finished"+dataStore)}),app.get("/data-save",function(e,n,a){console.log(dataStore+"i love storing"),n.send(dataStore)});var server=app.listen(3e3,function(){var e=server.address().address,n=server.address().port;console.log("Example app listening at http://%s:%s",e,n)});